import{d as y}from"./dayjs.min.9bf2e87d.js";import{r as h,j as o}from"./index.97949133.js";import{A as C,a as L}from"./index.esm.ad289017.js";import{g as O,O as j,W as k,a as g,b}from"./utils.160ae502.js";import{v as D}from"./v4.90f1a8cc.js";import"./_commonjsHelpers.294d03c4.js";const z=15,E=8,R=e=>[{id:D(),title:1,startTime:e+3*j,endTime:e+4*j}],Y=()=>{const[e,i]=h.exports.useState(O(Date.now())),[c,n]=h.exports.useState(R(e)),r=h.exports.useRef(null),d=t=>{const s=r.current;if(!s)return;const f=s.getBoundingClientRect(),u=t.clientY-f.y,w=s.scrollTop+u-E,T=Math.floor(w/z),m=e+T*b,x=m+j;m>=e+g||n(v=>v.concat({id:D(),title:1,startTime:m,endTime:x}))},a=y(e).format("YYYY\u5E74MM\u6708DD\u65E5"),l=k[y(e).day()];return o.exports.jsxs("div",{className:"relative overflow-auto h-full flex flex-col",children:[o.exports.jsxs("div",{className:"flex items-center border-b mb-2",children:[o.exports.jsx("button",{onClick:()=>i(e-g),className:"hover:bg-gray-200 rounded",children:o.exports.jsx(C,{className:"h-5 w-5"})}),o.exports.jsx("button",{onClick:()=>i(e+g),className:"hover:bg-gray-200 rounded ml-2",children:o.exports.jsx(L,{className:"h-5 w-5"})}),o.exports.jsx("p",{className:"ml-4",children:`${a} \u5468${l}`})]}),o.exports.jsx("div",{className:"overflow-auto flex-1",onDoubleClick:d,ref:r,children:o.exports.jsxs("div",{className:"relative ml-[55px] pt-2",children:[new Array(25).fill(1).map((t,s)=>o.exports.jsx("div",{style:{height:z*4},className:"relative h-[1px] border-t",children:o.exports.jsx("span",{className:"absolute -translate-x-full -translate-y-1/2 -ml-2",children:y(e+s*b*4).format("HH:mm")})},s)),o.exports.jsx("div",{className:"absolute top-0 left-0 w-full",onDoubleClick:t=>t.stopPropagation(),children:c.map(t=>{const{startTime:s,endTime:f}=t;return!s||!f||s<e||s>e+g?null:o.exports.jsx(H,{today:e,todo:t,container:r.current},t.id)})})]})})]})},p={left:"left",top:"top",right:"right",bottom:"bottom",rightTop:"rightTop",rightBottom:"rightBottom",leftTop:"leftTop",leftBottom:"leftBottom"},H=e=>{const{todo:i,today:c,container:n}=e,{startTime:r,endTime:d,title:a}=i,l=h.exports.useRef(null);return h.exports.useEffect(()=>{const t=l.current;!t||A({source:t,resizeDir:[p.top,p.bottom],scrollContainer:n!=null?n:void 0})},[]),!r||!d?null:o.exports.jsx("div",{ref:l,className:"absolute border rounded w-full bg-green-100",style:{top:(r-c)/b*z+E,height:(d-r)/b*z},children:a})},A=e=>{const{source:i,onResizeEnd:c,onResizing:n,onClick:r,scrollContainer:d,resizeDir:a=Object.keys(p),needInner:l=!1}=e,t=document.createElement("div");let s="";t.style.cursor="move",a.includes(p.top)&&(s+=l?'<div class="resize-top"><div class="resize-top-inner"></div></div>':'<div class="resize-top"></div>'),a.includes(p.right)&&(s+=l?'<div class="resize-right"><div class="resize-right-inner"></div></div>':'<div class="resize-right"></div>'),a.includes(p.bottom)&&(s+=l?'<div class="resize-bottom"><div class="resize-bottom-inner"></div></div>':'<div class="resize-bottom"></div>'),a.includes(p.left)&&(s+=l?'<div class="resize-left"><div class="resize-left-inner"></div></div>':'<div class="resize-left"></div>'),t.innerHTML=s,i.appendChild(t);const f=u=>{u.stopPropagation(),u.preventDefault(),u.target.className;const T={x:u.clientX,y:u.clientY};let m=!1;const x=N=>{m=!0,i.style.height=`${i.clientHeight+(N.clientY-T.y)}px`,n==null||n()},v=N=>{if(document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",v),!m){r==null||r(N);return}c==null||c()},M=()=>{};d&&d.addEventListener("scroll",M),document.addEventListener("mousemove",x),document.addEventListener("mouseup",v)};t.addEventListener("mousedown",f),i.appendChild(t)},W=()=>o.exports.jsx(Y,{});export{W as default};
