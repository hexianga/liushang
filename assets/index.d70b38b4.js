var Te=Object.defineProperty,Ae=Object.defineProperties;var ve=Object.getOwnPropertyDescriptors;var fe=Object.getOwnPropertySymbols;var Me=Object.prototype.hasOwnProperty,Fe=Object.prototype.propertyIsEnumerable;var se=(e,t,n)=>t in e?Te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,H=(e,t)=>{for(var n in t||(t={}))Me.call(t,n)&&se(e,n,t[n]);if(fe)for(var n of fe(t))Fe.call(t,n)&&se(e,n,t[n]);return e},X=(e,t)=>Ae(e,ve(t));import{r as h,j as l}from"./index.7adf6b61.js";import{i as ee,S as Ne,b as de,k as he,a as Le,O as x,D as Be,c as K,g as T,d as Se,e as ke}from"./type.e3281f5e.js";import{a as be,r as ae,d as Re,c as je}from"./intersection-ratio.15c8905b.js";import{i as pe,a as oe,c as z}from"./index.5729db34.js";import{n as ue}from"./number.0f6f4a78.js";import{s as Ie,o as Oe,i as te,b as ne,a as me,t as xe,h as Ye,c as J,d as Pe}from"./hasIn.d3012ea1.js";import{i as Ge,e as _e,a as De}from"./_arrayPush.17db8b7a.js";import{v as Q}from"./v4.90f1a8cc.js";import{A as Ue,a as $e}from"./index.esm.80733544.js";import"./index.563d4b32.js";function ze(e,t){return Ie(Oe(e,t,te),e+"")}function ie(e,t,n){if(!pe(n))return!1;var r=typeof t;return(r=="number"?ee(n)&&Ge(t,n.length):r=="string"&&t in n)?_e(n[t],e):!1}function qe(e,t,n){var r=e==null?void 0:ne(e,t);return r===void 0?n:r}var He=1,Xe=2;function Ze(e,t,n,r){var c=n.length,f=c,s=!r;if(e==null)return!f;for(e=Object(e);c--;){var b=n[c];if(s&&b[2]?b[1]!==e[b[0]]:!(b[0]in e))return!1}for(;++c<f;){b=n[c];var u=b[0],a=e[u],o=b[1];if(s&&b[2]){if(a===void 0&&!(u in e))return!1}else{var i=new Ne;if(r)var d=r(a,o,u,e,t,i);if(!(d===void 0?de(o,a,He|Xe,r,i):d))return!1}}return!0}function ge(e){return e===e&&!pe(e)}function We(e){for(var t=he(e),n=t.length;n--;){var r=t[n],c=e[r];t[n]=[r,c,ge(c)]}return t}function Ee(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}function Ke(e){var t=We(e);return t.length==1&&t[0][2]?Ee(t[0][0],t[0][1]):function(n){return n===e||Ze(n,e,t)}}var Je=1,Qe=2;function Ve(e,t){return me(e)&&ge(t)?Ee(xe(e),t):function(n){var r=qe(n,e);return r===void 0&&r===t?Ye(n,e):de(t,r,Je|Qe)}}function et(e){return function(t){return t==null?void 0:t[e]}}function tt(e){return function(t){return ne(t,e)}}function nt(e){return me(e)?et(xe(e)):tt(e)}function rt(e){return typeof e=="function"?e:e==null?te:typeof e=="object"?De(e)?Ve(e[0],e[1]):Ke(e):nt(e)}function ct(e){return function(t,n,r){for(var c=-1,f=Object(t),s=r(t),b=s.length;b--;){var u=s[e?b:++c];if(n(f[u],u,f)===!1)break}return t}}var ft=ct(),st=ft;function bt(e,t){return e&&st(e,t,he)}function at(e,t){return function(n,r){if(n==null)return n;if(!ee(n))return e(n,r);for(var c=n.length,f=t?c:-1,s=Object(n);(t?f--:++f<c)&&r(s[f],f,s)!==!1;);return n}}var ot=at(bt),ut=ot;function it(e,t){var n=-1,r=ee(e)?Array(e.length):[];return ut(e,function(c,f,s){r[++n]=t(c,f,s)}),r}function lt(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}function dt(e,t){if(e!==t){var n=e!==void 0,r=e===null,c=e===e,f=oe(e),s=t!==void 0,b=t===null,u=t===t,a=oe(t);if(!b&&!a&&!f&&e>t||f&&s&&u&&!b&&!a||r&&s&&u||!n&&u||!c)return 1;if(!r&&!f&&!a&&e<t||a&&n&&c&&!r&&!f||b&&n&&c||!s&&c||!u)return-1}return 0}function ht(e,t,n){for(var r=-1,c=e.criteria,f=t.criteria,s=c.length,b=n.length;++r<s;){var u=dt(c[r],f[r]);if(u){if(r>=b)return u;var a=n[r];return u*(a=="desc"?-1:1)}}return e.index-t.index}function pt(e,t,n){t.length?t=J(t,function(f){return De(f)?function(s){return ne(s,f.length===1?f[0]:f)}:f}):t=[te];var r=-1;t=J(t,Le(rt));var c=it(e,function(f,s,b){var u=J(t,function(a){return a(f)});return{criteria:u,index:++r,value:f}});return lt(c,function(f,s){return ht(f,s,n)})}var mt=ze(function(e,t){if(e==null)return[];var n=t.length;return n>1&&ie(e,t[0],t[1])?t=[]:n>2&&ie(t[0],t[1],t[2])&&(t=[t[0]]),pt(e,Pe(t,1),[])}),le=mt;const xt=4,Dt=4,gt=22,Ce=36,V=(e=1)=>xt*2+gt*e+Dt;var B=(e=>(e.SINGLE="SINGLE",e.MULTIPLE="MULTIPLE",e))(B||{});const we=h.exports.createContext(void 0),ye=h.exports.createContext(void 0),W=()=>{const e=h.exports.useContext(we);if(!e)throw new Error("useCalender");return e},re=()=>{const e=h.exports.useContext(ye);if(!e)throw new Error("useCalender");return e},Et=h.exports.memo(e=>{var R;const{id:t,renderStartDate:n,weekStartDate:r,weekEndDate:c,weekFirstDay:f,isStartDate:s,isEndDate:b,order:u}=e,{container:a,calenderDatesRef:o}=W(),{todoListRef:i,setTodoList:d}=re(),D=h.exports.useRef({x:0,y:0}),M=(p,y)=>{p.preventDefault(),p.stopPropagation();const S=a.current;if(!S)return;const k=y===K.left;let G,j={x:p.clientX,y:p.clientY};const L=v=>{j={x:v.clientX,y:v.clientY},be({y:v.clientY,container:S}),O(v.clientX,v.clientY)},E=()=>{S.removeEventListener("scroll",I),document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",E),cancelAnimationFrame(ae)},I=()=>O(j.x,j.y),O=(v,U)=>{let _=1/0;if(S.querySelectorAll(".calendar-date").forEach((C,g)=>{const A=C.getBoundingClientRect(),Y=Re(je(A),{x:v,y:U});Y<_&&(_=Y,G=g)}),typeof G=="undefined")return;const m=o.current[G],w=i.current.find(C=>C.id===t);!w||(k&&w.startTime!==m||!k&&w.endTime!==m)&&d(C=>C.map(g=>g.id===t&&g.endTime&&g.startTime?X(H({},g),{startTime:k&&m<=g.endTime?m:g.startTime,endTime:!k&&m>=g.startTime?m:g.endTime}):g))};S.addEventListener("scroll",I),document.addEventListener("mousemove",L),document.addEventListener("mouseup",E)},F=p=>{p.preventDefault(),D.current={x:p.clientX,y:p.clientY};const y=a.current;if(!y)return;const S=p.currentTarget,k=S.getBoundingClientRect(),G=k.width/(parseFloat(S.style.width)/100)/7,j=n+Math.floor((p.clientX-k.left)/G)*x;let L=!1,E,I,O={x:p.clientX,y:p.clientY};const v=m=>{O={x:m.clientX,y:m.clientY},!(!L&&Math.abs(m.clientX-D.current.x)<5&&Math.abs(m.clientY-D.current.y)<5)&&(L||(L=!0,E=document.createElement("div"),E.style.position="fixed",E.style.inset="0",E.style.zIndex="100",y.querySelectorAll(`[data-todo-id="${t}"]`).forEach(C=>{const g=C.getBoundingClientRect(),A=C.cloneNode(!0);A.style.position="absolute",A.style.width=`${g.width}px`,A.style.height=`${g.height}px`,A.style.top=`${g.top}px`,A.style.left=`${g.left}px`,E==null||E.appendChild(A)}),document.body.appendChild(E)),be({y:m.clientY,container:y}),U(m.clientX,m.clientY))},U=(m,w)=>{if(!E)return;E.style.transform=`translate(${m-D.current.x}px, ${w-D.current.y}px)`;const C=y.querySelector(".calendar-date.drag-hover-highlight");C==null||C.classList.remove("drag-hover-highlight");const g=y.querySelectorAll(".calendar-date");Array.from(g).find((A,Y)=>{const P=A.getBoundingClientRect(),ce=m>=P.left&&m<=P.right&&w>=P.top&&w<=P.bottom;return ce&&(I=Y,A.classList.add("drag-hover-highlight")),ce})},_=()=>{y.removeEventListener("scroll",$),document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",_),cancelAnimationFrame(ae),E==null||E.remove();const m=y.querySelector(".calendar-date.drag-hover-highlight");if(m==null||m.classList.remove("drag-hover-highlight"),!L||typeof I=="undefined")return;const w=i.current.find(Y=>Y.id===t);if(!w||!w.startTime||!w.endTime)return;const C=o.current[I];if(C===j)return;const g=C-(j-w.startTime),A=g+w.endTime-w.startTime;d(Y=>Y.map(P=>P.id===t?X(H({},P),{startTime:g,endTime:A}):P))},$=()=>{U(O.x,O.y)};y.addEventListener("scroll",$),document.addEventListener("mousemove",v),document.addEventListener("mouseup",_)},N={top:u*V()+Ce,left:ue((r-f)/x/7),width:ue(((c-r)/x+1)/7),height:V()};return l.exports.jsx("div",{"data-todo-id":t,className:z("absolute cursor-pointer pb-1",{"pl-1":s,"pr-1":b}),style:N,onMouseDown:F,children:l.exports.jsxs("div",{className:z("relative h-full border bg-green-300 p-1",{"rounded-l":s,"rounded-r":b}),children:[l.exports.jsx("span",{children:(R=i.current.find(p=>p.id===t))==null?void 0:R.title}),Be.map(p=>{if(p===K.left&&s)return l.exports.jsx("div",{className:"absolute top-0 -left-0.5 z-10 h-full w-[4px] rounded-full py-0.5 hover:cursor-col-resize hover:bg-black",onMouseDown:y=>M(y,p)},p);if(p===K.right&&b)return l.exports.jsx("div",{className:"absolute top-0 -right-0.5 z-10 h-full w-[4px] rounded-full py-0.5 hover:cursor-col-resize hover:bg-black",onMouseDown:y=>M(y,p)},p)})]})},t)}),Ct=(e,t)=>{const{todoList:n}=re(),r=[];n.forEach(({startTime:s,endTime:b,id:u})=>{if(!s||!b)return;const a=s||b,o=b||s;if(!a||!o)return;const i=T(a),d=T(o);if(d<e||i>t)return;const D=i>=e&&i<=t?i:e,M=d>=e&&d<=t?d:t;r.push({id:u,rawStartTime:s,rawEndTime:b,renderStartDate:a,renderEndDate:o,weekStartDate:D,weekEndDate:M,isStartDate:D===i,isEndDate:M===d,order:0})});const c=le(r,s=>s.weekStartDate),f={};return c.forEach(s=>{var o,i;let b=0;const u=f[s.weekStartDate];u&&(b=Object.entries(le(u)).findIndex(([d,D])=>Number(d)!==D),b=b===-1?u.length:b);let a=s.weekStartDate;for(;a<=s.weekEndDate;)f[a]=(o=f[a])!=null?o:[],(i=f[a])==null||i.push(b),a+=x;s.order=b}),c},wt=h.exports.memo(({firstDay:e,lastDay:t,weekRef:n})=>{const r=Ct(e,t);return h.exports.useEffect(()=>{const c=n.current;if(!c)return;const f=124;if(r.length===0)c.style.height=`${f}px`;else{const s={};r.forEach(a=>{let o=a.weekStartDate;for(;o<=a.weekEndDate;)s[o]=(s[o]||0)+1,o=o+x});const u=Math.max(...Object.values(s))*V()+Ce;c.style.height=`${Math.max(u,f)}px`}},[r,n]),r.length===0?null:l.exports.jsx(l.exports.Fragment,{children:r.map(c=>h.exports.createElement(Et,X(H({},c),{weekFirstDay:e,key:c.id})))})}),yt={lunarInfo:[19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,92821,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42416,83315,21168,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46752,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,23232,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19195,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448,84835,37744,18936,18800,25776,92326,59984,27424,108228,43744,37600,53987,51552,54615,54432,55888,23893,22176,42704,21972,21200,43448,43344,46240,46758,44368,21920,43940,42416,21168,45683,26928,29495,27296,44368,84821,19296,42352,21732,53600,59752,54560,55968,92838,22224,19168,43476,41680,53584,62034,54560],solarMonth:[31,28,31,30,31,30,31,31,30,31,30,31],Gan:["\u7532","\u4E59","\u4E19","\u4E01","\u620A","\u5DF1","\u5E9A","\u8F9B","\u58EC","\u7678"],Zhi:["\u5B50","\u4E11","\u5BC5","\u536F","\u8FB0","\u5DF3","\u5348","\u672A","\u7533","\u9149","\u620C","\u4EA5"],Animals:["\u9F20","\u725B","\u864E","\u5154","\u9F99","\u86C7","\u9A6C","\u7F8A","\u7334","\u9E21","\u72D7","\u732A"],festival:{"1-1":{title:"\u5143\u65E6\u8282"},"2-14":{title:"\u60C5\u4EBA\u8282"},"5-1":{title:"\u52B3\u52A8\u8282"},"5-4":{title:"\u9752\u5E74\u8282"},"6-1":{title:"\u513F\u7AE5\u8282"},"9-10":{title:"\u6559\u5E08\u8282"},"10-1":{title:"\u56FD\u5E86\u8282"},"12-25":{title:"\u5723\u8BDE\u8282"},"3-8":{title:"\u5987\u5973\u8282"},"3-12":{title:"\u690D\u6811\u8282"},"4-1":{title:"\u611A\u4EBA\u8282"},"5-12":{title:"\u62A4\u58EB\u8282"},"7-1":{title:"\u5EFA\u515A\u8282"},"8-1":{title:"\u5EFA\u519B\u8282"},"12-24":{title:"\u5E73\u5B89\u591C"}},lFestival:{"12-30":{title:"\u9664\u5915"},"1-1":{title:"\u6625\u8282"},"1-15":{title:"\u5143\u5BB5\u8282"},"2-2":{title:"\u9F99\u62AC\u5934"},"5-5":{title:"\u7AEF\u5348\u8282"},"7-7":{title:"\u4E03\u5915\u8282"},"7-15":{title:"\u4E2D\u5143\u8282"},"8-15":{title:"\u4E2D\u79CB\u8282"},"9-9":{title:"\u91CD\u9633\u8282"},"10-1":{title:"\u5BD2\u8863\u8282"},"10-15":{title:"\u4E0B\u5143\u8282"},"12-8":{title:"\u814A\u516B\u8282"},"12-23":{title:"\u5317\u65B9\u5C0F\u5E74"},"12-24":{title:"\u5357\u65B9\u5C0F\u5E74"}},getFestival(){return this.festival},getLunarFestival(){return this.lFestival},setFestival(e={}){this.festival=e},setLunarFestival(e={}){this.lFestival=e},solarTerm:["\u5C0F\u5BD2","\u5927\u5BD2","\u7ACB\u6625","\u96E8\u6C34","\u60CA\u86F0","\u6625\u5206","\u6E05\u660E","\u8C37\u96E8","\u7ACB\u590F","\u5C0F\u6EE1","\u8292\u79CD","\u590F\u81F3","\u5C0F\u6691","\u5927\u6691","\u7ACB\u79CB","\u5904\u6691","\u767D\u9732","\u79CB\u5206","\u5BD2\u9732","\u971C\u964D","\u7ACB\u51AC","\u5C0F\u96EA","\u5927\u96EA","\u51AC\u81F3"],sTermInfo:["9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","9778397bd19801ec9210c965cc920e","97b6b97bd19801ec95f8c965cc920f","97bd09801d98082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd197c36c9210c9274c91aa","97b6b97bd19801ec95f8c965cc920e","97bd09801d98082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec95f8c965cc920e","97bcf97c3598082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd07f595b0b6fc920fb0722","9778397bd097c36b0b6fc9210c8dc2","9778397bd19801ec9210c9274c920e","97b6b97bd19801ec95f8c965cc920f","97bd07f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c920e","97b6b97bd19801ec95f8c965cc920f","97bd07f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec9210c965cc920e","97bd07f1487f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c9274c920e","97bcf7f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c91aa","97b6b97bd197c36c9210c9274c920e","97bcf7f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c920e","97b6b7f0e47f531b0723b0b6fb0722","7f0e37f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36b0b70c9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e37f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc9210c8dc2","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0787b0721","7f0e27f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c91aa","97b6b7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c8dc2","977837f0e37f149b0723b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f5307f595b0b0bc920fb0722","7f0e397bd097c35b0b6fc9210c8dc2","977837f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0721","7f0e37f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc9210c8dc2","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0723b06bd","7f07e7f0e37f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f1487f595b0b0bb0b6fb0722","7f0e37f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e37f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0723b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0723b06bd","7f07e7f0e37f14998083b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14898082b0723b02d5","7f07e7f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e36665b66aa89801e9808297c35","665f67f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e36665b66a449801e9808297c35","665f67f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e36665b66a449801e9808297c35","665f67f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e26665b66a449801e9808297c35","665f67f0e37f1489801eb072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722"],nStr1:["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341"],nStr2:["\u521D","\u5341","\u5EFF","\u5345"],nStr3:["\u6B63","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u51AC","\u814A"],lYearDays:function(e){let t,n=348;for(t=32768;t>8;t>>=1)n+=this.lunarInfo[e-1900]&t?1:0;return n+this.leapDays(e)},leapMonth:function(e){return this.lunarInfo[e-1900]&15},leapDays:function(e){return this.leapMonth(e)?this.lunarInfo[e-1900]&65536?30:29:0},monthDays:function(e,t){return t>12||t<1?-1:this.lunarInfo[e-1900]&65536>>t?30:29},solarDays:function(e,t){if(t>12||t<1)return-1;const n=t-1;return n===1?e%4===0&&e%100!==0||e%400===0?29:28:this.solarMonth[n]},toGanZhiYear:function(e){var t=(e-3)%10,n=(e-3)%12;return t===0&&(t=10),n===0&&(n=12),this.Gan[t-1]+this.Zhi[n-1]},toAstro:function(e,t){const n="\u9B54\u7FAF\u6C34\u74F6\u53CC\u9C7C\u767D\u7F8A\u91D1\u725B\u53CC\u5B50\u5DE8\u87F9\u72EE\u5B50\u5904\u5973\u5929\u79E4\u5929\u874E\u5C04\u624B\u9B54\u7FAF",r=[20,19,21,21,21,22,23,23,23,23,22,22];return n.substr(e*2-(t<r[e-1]?2:0),2)+"\u5EA7"},toGanZhi:function(e){return this.Gan[e%10]+this.Zhi[e%12]},getTerm:function(e,t){if(e<1900||e>2100||t<1||t>24)return-1;const n=this.sTermInfo[e-1900],r=[];for(let c=0;c<n.length;c+=5){const f=parseInt("0x"+n.substr(c,5)).toString();r.push(f[0],f.substr(1,2),f[3],f.substr(4,2))}return parseInt(r[t-1])},toChinaMonth:function(e){if(e>12||e<1)return-1;let t=this.nStr3[e-1];return t+="\u6708",t},toChinaDay:function(e){let t;switch(e){case 10:t="\u521D\u5341";break;case 20:t="\u4E8C\u5341";break;case 30:t="\u4E09\u5341";break;default:t=this.nStr2[Math.floor(e/10)],t+=this.nStr1[e%10]}return t},getAnimal:function(e){return this.Animals[(e-4)%12]},solar2lunar:function(e,t,n){let r=parseInt(e),c=parseInt(t),f=parseInt(n);if(r<1900||r>2100||r===1900&&c===1&&f<31)return-1;let s;r?s=new Date(r,parseInt(c)-1,f):s=new Date;let b,u=0,a=0;r=s.getFullYear(),c=s.getMonth()+1,f=s.getDate();let o=(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate())-Date.UTC(1900,0,31))/864e5;for(b=1900;b<2101&&o>0;b++)a=this.lYearDays(b),o-=a;o<0&&(o+=a,b--);let i=new Date,d=!1;i.getFullYear()===r&&i.getMonth()+1===c&&i.getDate()===f&&(d=!0);let D=s.getDay(),M=this.nStr1[D];D===0&&(D=7);const F=b;u=this.leapMonth(b);let N=!1;for(b=1;b<13&&o>0;b++)u>0&&b===u+1&&N===!1?(--b,N=!0,a=this.leapDays(F)):a=this.monthDays(F,b),N===!0&&b===u+1&&(N=!1),o-=a;o===0&&u>0&&b===u+1&&(N?N=!1:(N=!0,--b)),o<0&&(o+=a,--b);const R=b,p=o+1,y=c-1,S=this.toGanZhiYear(F),k=this.getTerm(r,c*2-1),G=this.getTerm(r,c*2);let j=this.toGanZhi((r-1900)*12+c+11);f>=k&&(j=this.toGanZhi((r-1900)*12+c+12));let L=!1,E=null;k===f&&(L=!0,E=this.solarTerm[c*2-2]),G===f&&(L=!0,E=this.solarTerm[c*2-1]);const I=Date.UTC(r,y,1,0,0,0,0)/864e5+25567+10,O=this.toGanZhi(I+f-1),v=this.toAstro(c,f),U=r+"-"+c+"-"+f,_=F+"-"+R+"-"+p,$=this.festival,m=this.lFestival,w=c+"-"+f;let C=R+"-"+p;return R===12&&p===29&&this.monthDays(F,R)===29&&(C="12-30"),{date:U,lunarDate:_,festival:$[w]?$[w].title:null,lunarFestival:m[C]?m[C].title:null,lYear:F,lMonth:R,lDay:p,Animal:this.getAnimal(F),IMonthCn:(N?"\u95F0":"")+this.toChinaMonth(R),IDayCn:this.toChinaDay(p),cYear:r,cMonth:c,cDay:f,gzYear:S,gzMonth:j,gzDay:O,isToday:d,isLeap:N,nWeek:D,ncWeek:"\u661F\u671F"+M,isTerm:L,Term:E,astro:v}},lunar2solar:function(e,t,n,r){e=parseInt(e),t=parseInt(t),n=parseInt(n),r=!!r;const c=this.leapMonth(e);if(this.leapDays(e),r&&c!==t||e===2100&&t===12&&n>1||e===1900&&t===1&&n<31)return-1;const f=this.monthDays(e,t);let s=f;if(r&&(s=this.leapDays(e,t)),e<1900||e>2100||n>s)return-1;let b=0,u;for(u=1900;u<e;u++)b+=this.lYearDays(u);let a=0,o=!1;for(u=1;u<t;u++)a=this.leapMonth(e),o||a<=u&&a>0&&(b+=this.leapDays(e),o=!0),b+=this.monthDays(e,u);r&&(b+=f);const i=Date.UTC(1900,1,30,0,0,0),d=new Date((b+n-31)*864e5+i),D=d.getUTCFullYear(),M=d.getUTCMonth()+1,F=d.getUTCDate();return this.solar2lunar(D,M,F)}},Tt=h.exports.memo(({date:e,setTodoList:t})=>{const n=Se(e),r=new Date(e),c=yt.solar2lunar(r.getFullYear(),r.getMonth()+1,r.getDate());return h.exports.useMemo(()=>l.exports.jsxs("div",{className:"calendar-date group relative flex flex-1 justify-between border-r border-b px-2 text-right text-gray-200",children:[l.exports.jsx("button",{className:"absolute top-0.5 left-10 flex h-5 w-5 cursor-pointer items-center rounded border bg-white text-center text-sm text-black opacity-0 group-hover:opacity-100",onClick:()=>{t(f=>{var s;return f.concat({id:Q(),title:((s=f[f.length-1].title)!=null?s:0)+1,startTime:e,endTime:e})})},children:"+"}),l.exports.jsx("span",{className:z(n&&"inline-block h-6 w-6 rounded-full bg-red-500 text-center font-bold text-white"),children:r.getDate()}),c!==-1&&l.exports.jsx("span",{className:z("ml-1 ",(c.lunarFestival||c.Term)&&"text-red-400"),children:c.lunarFestival||c.Term?c.lunarFestival||c.Term:c.lDay===1?c.IMonthCn:c.IDayCn})]}),[e,r,c,t,n])}),At=h.exports.memo(({dates:e,setCurrentMonth:t,setTodoList:n})=>{const{container:r,calenderHeader:c,showType:f}=W(),s=h.exports.useRef(null);return h.exports.useEffect(()=>{if(f===B.SINGLE)return;const b=r.current;if(!b)return;const u=()=>{var i;if(!s.current||!c.current)return;const a=(i=s.current)==null?void 0:i.getBoundingClientRect(),o=c.current.getBoundingClientRect();o.bottom>a.top&&o.bottom<a.bottom&&t(d=>{const D=e[e.length-1]+x;return D!==d?T(new Date(D).setDate(1)):d})};b.addEventListener("scroll",u)},[c,r,e,t,f]),l.exports.jsxs("div",{className:"calendar-week relative flex min-h-[96px] w-full",ref:s,children:[e.map(b=>l.exports.jsx(Tt,{date:b,setTodoList:n},b)),l.exports.jsx(wt,{firstDay:e[0],lastDay:e[e.length-1],weekRef:s})]})},ke),q=(e="init",t)=>{let n=0,r=0;if(e==="init"){const s=t?new Date(t):new Date,b=s.getMonth(),u=s.setMonth(b,1),a=s.setMonth(b+2,0);n=T(u-((new Date(u).getDay()||7)-1)*x)-x,r=T(a-((new Date(a).getDay()||7)-1)*x)+x*5}if(e==="append"&&t){const s=new Date(t),b=s.setMonth(s.getMonth()+2,0);n=t,r=T(b-((new Date(b).getDay()||7)-1)*x)+x*5}const c=[];let f=n;for(;f<=r;)c.push(f),f+=x;return c},Z=(e=Date.now())=>{const t=new Date(e),n=t.getMonth(),r=t.setMonth(n,1),c=t.setMonth(n+1,0),s=T(r-((new Date(r).getDay()||7)-1)*x)-x,u=T(c-((new Date(c).getDay()||7)-1)*x)+x*5,a=[];let o=s;for(;o<=u;)a.push(o),o+=x;return a},vt=(e,t,n)=>{const r=T(new Date(e).setDate(1)),c=T(new Date(e).setMonth(new Date(e).getMonth()+1,0)),f=t.indexOf(r),s=(c-r)/x+1;n.querySelectorAll(".calendar-date.current-month").forEach(a=>a.classList.remove("current-month"));const u=n.querySelectorAll(".calendar-date");Array.from(u).slice(f,f+s).forEach(a=>{a.classList.add("current-month")})},Mt=({currentMonth:e,setCurrentMonth:t})=>{const{calenderHeader:n,setCalenderDates:r,container:c,calenderDates:f,showType:s,setShowType:b}=W();h.exports.useEffect(()=>{const o=c.current;!o||vt(e,f,o)},[f,c,e]);const u=o=>{let i=Date.now();if(o==="today")i=new Date().setDate(1);else{const d=new Date(e),D=d.getMonth(),M=o==="pre"?D-1:D+1;i=d.setMonth(M,1)}if(t(i),s===B.SINGLE)r(Z(i));else{const d=c.current;if(!d)return;r(q("init",i)),d.scrollTop=0}},a=new Date(e);return l.exports.jsxs("div",{className:"sticky top-0 z-10 flex w-full flex-col justify-between border bg-white py-2 px-2",ref:n,children:[l.exports.jsxs("div",{className:"flex h-8 items-center",children:[l.exports.jsx("div",{className:"flex h-full bg-white",children:e&&l.exports.jsxs("span",{className:"inline-flex h-full items-center",children:[a.getFullYear(),"\u5E74",a.getMonth()+1,"\u6708"]})}),l.exports.jsxs("div",{className:"ml-auto flex items-center bg-white",children:[l.exports.jsx("button",{onClick:()=>{const o=Date.now();t(o),b(B.SINGLE),console.log(Z(o)),r(Z(o))},className:z(s===B.SINGLE&&"bg-gray-200"),children:"\u5355\u6708"}),l.exports.jsx("button",{onClick:()=>{const o=Date.now();t(o),b(B.MULTIPLE),r(q("init",o))},className:z(s===B.MULTIPLE&&"bg-gray-200"),children:"\u591A\u6708"}),l.exports.jsx("button",{onClick:()=>u("pre"),children:l.exports.jsx(Ue,{className:"h-5 w-5"})}),l.exports.jsx("button",{className:"cursor-pointer bg-white px-2",onClick:()=>u("today"),children:"\u4ECA\u5929"}),l.exports.jsx("button",{onClick:()=>u("next"),children:l.exports.jsx($e,{className:"h-5 w-5"})})]})]}),l.exports.jsx("div",{className:"mt-2 flex",children:"\u65E5_\u4E00_\u4E8C_\u4E09_\u56DB_\u4E94_\u516D".split("_").map(o=>l.exports.jsxs("div",{className:"flex-1 text-center",children:["\u5468",o]},o))})]})},Gt=()=>{const[e,t]=h.exports.useState(B.SINGLE),[n,r]=h.exports.useState(e===B.SINGLE?Z():q()),c=h.exports.useRef([]),f=h.exports.useRef([]),s=h.exports.useRef(null),b=h.exports.useRef(null),[u,a]=h.exports.useState([{id:Q(),title:1,startTime:T(Date.now())+3*x,endTime:T(Date.now())+4*x},{id:Q(),title:2,startTime:T(Date.now())+5*x,endTime:T(Date.now())+6*x}]),o=h.exports.useMemo(()=>({container:s,showType:e,setShowType:t,calenderDates:n,setCalenderDates:r,calenderDatesRef:c,calenderHeader:b}),[e,n]),i=h.exports.useMemo(()=>({todoList:u,setTodoList:a,todoListRef:f}),[u,a,f]);return f.current=u,c.current=n,l.exports.jsx(we.Provider,{value:o,children:l.exports.jsx(ye.Provider,{value:i,children:l.exports.jsx(Ft,{})})})},Ft=()=>{const{setTodoList:e}=re(),{container:t,calenderDates:n,setCalenderDates:r,showType:c}=W(),f=h.exports.useRef(!1),s=h.exports.useRef(c);s.current=c;const[b,u]=h.exports.useState(T(new Date().setDate(1)));return h.exports.useEffect(()=>{const a=t.current;if(!a)return;const o=()=>{if(s.current===B.SINGLE)return;const i=t.current;!i||i.scrollHeight<i.scrollTop+i.clientHeight+200&&!f.current&&(f.current=!0,r(d=>d.concat(q("append",d[d.length-1]+x))))};return a.addEventListener("scroll",o),()=>a.removeEventListener("scroll",o)},[t,r,c]),h.exports.useEffect(()=>{if(c===B.SINGLE)return;f.current=!1;const a=t.current;!a||a.scrollHeight<=a.clientHeight&&r(o=>o.concat(q("append",o[o.length-1]+x)))},[n.length,t,r,c]),l.exports.jsxs("div",{className:"relative mx-auto flex max-h-full w-full flex-col items-center overflow-auto",style:{background:"linear-gradient(90deg, #f5f5f5 14.285714285%, transparent 14.285714285%, transparent 85.714285714%, #f5f5f5 85.714285714%)"},ref:t,children:[l.exports.jsx(Mt,{currentMonth:b,setCurrentMonth:u}),l.exports.jsx("div",{className:"w-full min-w-max border-l",children:n.map((a,o)=>o%7===0?l.exports.jsx(At,{dates:n.slice(o,o+7),setCurrentMonth:u,setTodoList:e},a):null)})]})};export{Ft as Calender,Gt as default};
